---
title: 如何优雅地定位元素
description: 如何优雅地定位元素
sidebar_position: 4
last_update:
  author: 江洲泽
---

# 如何优雅地定位元素

## 🎯 前言
在做UI自动化的过程中，定位元素是最耗时，也是以后维护量最大的工作之一，如何优雅的定位元素也就成了我们必不可少的技能。    
Seleium 提供至少8种定位方式，基本的方式有通过ID，class name，name， tag，link text，partial link text，xpath，CSS selector，以及JS。    
但我们只选用 **xpath** 作为我们定位元素的方式，除了CSS selector，xpath包含其它6种定位方式，而且自身自带运算符和函数。

## 🎯 Xpath是什么？
XPath 是一门在 XML 文档中查找信息的语言。XPath 可用来在 XML 文档中对元素和属性进行遍历。    
XPath 是 W3C XSLT 标准的主要元素，并且 XQuery 和 XPointer 都构建于 XPath 表达之上。 
因此，对 XPath 的理解是很多高级 XML 应用的基础。

## 🎯 Xpath 从0到1
我把这个技能分为三个等级：学徒，大师，专家。    
学徒：能用基本的运算符定位到元素。  
大师：能够把相似的元素参数化。  
专家：快速解决元素定位不到的问题，优化元素定位方式。    
（可以参考 [W3school](https://www.w3school.com.cn/xpath/index.asp) ）

****

## 🐵 学徒
如何在页面找到xpath？   
1. 用Chrome或者IE打开领犀平台， 按F12， 会出现开发调试工具。 
![](@site/static/img/test_img/2022-08-08-12-15-44.png)   
1. 点击Elements， 会看到html 页面，点击左上角![](@site/static/img/test_img/2022-08-08-12-18-50.png)
2. 鼠标右键点击该元素，选择Copy → Copy Xpath （Copy full XPath）。 
![](@site/static/img/test_img/2022-08-08-12-16-16.png) 
4. 随便点击html ，然后按Ctrl + F，下方出现输入框。  
5. 粘贴从刚才的xpath，html会自动定位元素并且背景色标黄， 右下角会显示改xpath找到了几个元素。 
![](@site/static/img/test_img/2022-08-08-12-16-52.png)

### 💡 **需要掌握的技能--如何“告状”？**
![](@site/static/img/test_img/2022-08-08-12-17-18.png)    

👨‍👧‍👦 假如你们家举办家庭聚会， 你和表哥表姐玩了起来，但你被打了，你该如何告状？

⭐ 第一种：知道表哥名字    
//表哥[**@姓名**='张三']    

⭐ 第二种：只知道打你的表哥的父亲叫什么    
//父辈[**@姓名**='张老三']/表哥 

⭐ 第三种： 你不知道表哥叫什么，但知道他是三爸的儿子   
//父辈 **[3]**/表哥  

⭐ 第四种：你们玩的过程中关了灯，你不知道谁打了你，但你咬了他/她的手臂，且不知道是左手还是右手 
//*[@左手臂=‘有牙印’ **or** @右手臂=‘有牙印’]    

![](@site/static/img/test_img/2022-08-08-12-17-40.png)

👨‍👧‍👦 假如你们家举又办家庭聚会，这次你大姨二姨的孩子也加入了，你们又一起玩了起来，你又被打了，你又该如何告状？

⭐ 第一种：还是那个表哥打了你，但你要找他父亲理论
//表哥[@特征=‘上次打过我’]/**parent::***

⭐ 第二种：是爸这边的两个表哥联合欺负你，你找到他们
//父辈[@姓名=‘老爸’]/**following::父辈**/表哥

⭐ 第三种：在被打的过程中，三爸的表姐和二姨的表哥帮了你，你要表扬他们
//二姨/表哥 **|** //三爸/表姐

:::info 通过上面几个例子，我们可以总结出，要找到正确的对象，必须满足两个条件：

1. 必须有特征点
2. 尽量短且带有唯一性的关系层
:::
:::tip 提示
为了避免以后由于页面的变动，而导致我们xpath的修改，尽量：
在不影响唯一性的情况下尽可能的减少层级
尽量避免用索引
:::

### 💡 **需要掌握的技能--路径表达式**

| 表达式 | 描述 |
| ------------ | -------- |
| /	| 从根节点选取 |
| // | 	从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置 |
| .	| 选取当前节点 |
| .. | 选取当前节点的父节点 |
| @ | 选取属性 |

### 💡 **需要掌握的技能--XPath轴**  
轴可定义相对于当前节点的节点集。    

| 轴名称 | 结果 |     
| - | - |
| ancestor | 选取当前节点的所有先辈（父、祖父等） | 
| ancestor-or-self | 选取当前节点的所有先辈（父、祖父等）以及当前节点本身 | 
| attribute | 选取当前节点的所有属性 |  
| child | 选取当前节点的所有子元素 |    
| descendant | 选取当前节点的所有后代元素（子、孙等） | 
| descendant-or-self | 选取当前节点的所有后代元素（子、孙等）以及当前节点本身 | 
| following | 选取文档中当前节点的结束标签之后的所有节点 |  
| following-sibling | 选取当前节点之后的所有同级节点 |  
| namespace | 选取当前节点的所有命名空间节点 |  
| parent | 选取当前节点的父节点 |   
| preceding | 选取文档中当前节点的开始标签之前的所有节点 |  
| preceding-sibling | 选取当前节点之前的所有同级节点 |  
| self | 选取当前节点 | 

## 👤 大师

我们还是拿数商云云平台举例， 我们来到登录界面，常见的登录流程会用到三个元素，分别是用户，密码。 
它们的html分别是：  
用户：`<input class="ant-input" placeholder="用户名/手机号" id="account" type="text" value=""> `  
密码：`<input placeholder="请输入密码" action="click" id="password" type="password" class="ant-input"> `  


一般测试人员一看到元素有ID，肯定会想到用ID去找，那么元素的xpath分别是：    
用户： `//input[@id='account']`     
密码： `//input[@id='password']`    
这么写完全符合学徒篇里的要求，有特征，层级少且唯一。

但有没有人想过，这么写就是一个萝卜一个坑，页面有多少个元素，我们就得写多少个xpath，而且随时保证每一个元素都是正确的，比程序员直接拖一个元素花费更多的时间。 
那么问题来了，我们该怎么解决这种工作量大，且会给自己挖坑的工作呢？  
这时候，我们要换一种思路，程序员的思路，他们怎么设计每一类元素的，比如那么多文本框，他们不可能每个单独设计，肯定是统一样式，那他们怎么让用户识别填什么呢？  
这就是我们要做的，**从相似中找出不同，从不同中归纳统一**。   

**例如：能力中心的左侧菜单**
>
![](@site/static/img/test_img/2022-08-08-10-16-04.png)  
如果每个菜单都写一个定位就会浪费很多时间，我们可以观察它的元素组成
![](@site/static/img/test_img/2022-08-08-10-17-39.png)
我们可发现，每个不同的菜单只是改变了`laber`标签中text的值，那我们就可以通过传入不同的text来定位不同的左侧菜单
![](@site/static/img/test_img/2022-08-08-10-19-30.png)
![](@site/static/img/test_img/2022-08-08-10-19-53.png)